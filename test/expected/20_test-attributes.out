--              ██     ██          ██ ██                ██
--             ░██    ░██         ░░ ░██               ░██
--   ██████   ██████ ██████ ██████ ██░██      ██   ██ ██████  █████   ██████
--  ░░░░░░██ ░░░██░ ░░░██░ ░░██░░█░██░██████ ░██  ░██░░░██░  ██░░░██ ██░░░░
--   ███████   ░██    ░██   ░██ ░ ░██░██░░░██░██  ░██  ░██  ░███████░░█████
--  ██░░░░██   ░██    ░██   ░██   ░██░██  ░██░██  ░██  ░██  ░██░░░░  ░░░░░██
-- ░░████████  ░░██   ░░██ ░███   ░██░██████ ░░██████  ░░██ ░░██████ ██████
--  ░░░░░░░░    ░░     ░░  ░░░    ░░ ░░░░░    ░░░░░░    ░░   ░░░░░░ ░░░░░░
-- attributes:
--
BEGIN;
SET client_min_messages TO WARNING;
CREATE EXTENSION pgdeploy;
CREATE SCHEMA testr;
CREATE SCHEMA testp;
CREATE TABLE testr.a(i int, ii text, iii bit);
CREATE TABLE testp.a(ii text, iv numeric CONSTRAINT positive_price CHECK (iv > 0));
SELECT pgdeploy.reconcile_table_attributes(
    'testr'::name, 'a'::name, 'testr.a'::regclass::oid
    ,'testp'::name, 'a'::name, 'testp.a'::regclass::oid);
           reconcile_table_attributes            
-------------------------------------------------
 ALTER TABLE testr.a ADD COLUMN iv numeric NULL;
 ALTER TABLE testr.a DROP COLUMN i;
 ALTER TABLE testr.a DROP COLUMN iii;
 -- COLUMN: no change for ii
(4 rows)

-- CLEAN UP
DROP EXTENSION pgdeploy CASCADE;
ROLLBACK;
